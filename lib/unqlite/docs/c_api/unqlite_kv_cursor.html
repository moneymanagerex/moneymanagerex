<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en"><head>
















  
  <meta content="text/html; charset=UTF-8" http-equiv="content-type"><title>UnQLite C/C++ API Reference - Using Database Cursors</title><!-- Copyright (C) 2013 Mrad Chems Eddine, Symisc Systems,http://www.symisc.net contact@symisc.net -->
  

  

  
  <link rel="stylesheet" href="symisc.css" type="text/css">

  
  <meta content="Symisc Systems - Mrad Chems Eddine &lt;chm@symisc.net&gt;" name="author">

  
  <meta content="http://unqlite.org/" name="description"></head><body>
<div style="width: 1092px;" id="main_div"><a href="http://unqlite.org/"><img style="border: 0px solid ; width: 170px; height: 70px;" alt="Symisc UnQLite" title="Symisc UnQLite" src="../images/symisc-unqlite.png"></a><br>
<div style="text-align: left; width: 1080px;" align="right">
<table style="text-align: left; width: 1075px; height: 41px;" border="0" cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top; width: 709px; height: 45px;"><small style="color: black; font-family: Verdana;"><small><br>
An Embeddable NoSQL Database Engine<br>
      </small></small></td>
      <td style="vertical-align: top; width: 162px; height: 45px;"><br>
      <a href="https://twitter.com/share" class="twitter-share-button" data-via="unqlite_db" data-size="large">Tweet</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></td>
      <td style="vertical-align: top; width: 176px; height: 45px;"><br>
      <a href="https://twitter.com/unqlite_db" class="twitter-follow-button" data-show-count="false" data-size="large">Follow
@unqlite_db</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></td>
    </tr>
  </tbody>
</table>
</div>
<hr style="width: 100%; height: 2px;">
<ul id="nav">
  <li id="nav-1"><a href="../index.html">About</a></li>
  <li id="nav-8"><a href="../features.html">Distinctive Features<br>
    </a></li>
  <li id="nav-2"><a href="../intro.html">Getting Started<br>
    </a></li>
  <li id="nav-3"><a href="../c_api.html">Documentation<br>
    </a></li>
  <li id="nav-4"><a href="../downloads.html">Downloads<br>
    </a></li>
  <li id="nav-5"><a href="../licensing.html">License<br>
    </a></li>
  <li id="nav-6"><a href="../faq.html">FAQ<br>
    </a></li>
  <li id="nav-7"><a href="../support.html">Online Support<br>
    </a></li>
</ul>
<h1 style="font-family: Verdana;"><font style="font-size: 10pt;" size="2">UnQLite</font><small><small><b> C/C++ API Reference - </b></small></small><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2">Using Database Cursors.</font></font></h1>


<div><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b>Syntax</b></font></font><br>
<br>
<div style="margin-left: 40px;"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2">Using database cursors.</font></font><br>
</div>

<p style="margin-left: 1.25cm; margin-bottom: 0cm; font-family: Courier New;">
</p>
<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Verdana, sans-serif"><font size="2"><b><br>
</b></font></font></p>
<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Verdana, sans-serif"><font size="2"><b>Opening
Database Cursors</b></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><br>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_init</b></font><font color="#000000">(</font><font style="color: blue;" color="#800000">unqlite</font><font color="#000000">
*pDb,<span style="color: blue;">unqlite_kv_cursor</span> **ppOut);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_release</b></font><font color="#000000">(<span style="color: blue;">unqlite</span>
*pDb,<span style="color: blue;">unqlite_kv_cursor</span> *pCur);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_reset</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><br>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#000000"><font face="Verdana, sans-serif"><b>Positioning
Database Cursors</b></font></font><font color="#000000"> </font></font></font>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><br>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_seek</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor,</font><font color="#0000ff">const</font><font color="#000000">
</font><font color="#0000ff">void</font><font color="#000000">
*pKey,</font><font color="#0000ff">int</font><font color="#000000">
nKeyLen,</font><font color="#0000ff">int</font><font color="#000000">
iPos);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_first_entry</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_last_entry</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_valid_entry</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_next_entry</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_prev_entry</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><br>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Verdana, sans-serif"><font size="2"><b><font color="#000000">Extracting
Data from Database Cursors</font></b></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><br>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_key(</b></font><font color="#000000"><span style="color: blue;">unqlite_kv_cursor</span>
*pCursor,</font><font color="#0000ff">void</font><font color="#000000">
*pBuf,</font><font color="#0000ff">int</font><font color="#000000">
*pnByte);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_key_callback</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor,</font><font color="#0000ff">int</font><font color="#000000">
(*xConsumer)(</font><font color="#0000ff">const</font><font color="#000000">
</font><font color="#0000ff">void</font><font color="#000000">
*,</font><font color="#0000ff">unsigned</font><font color="#000000">
</font><font color="#0000ff">int</font><font color="#000000">,</font><font color="#0000ff">void</font><font color="#000000">
*),</font><font color="#0000ff">void</font><font color="#000000">
*pUserData);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_data</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor,</font><font color="#0000ff">void</font><font color="#000000">
*pBuf,<span style="color: blue;">unqlite_int64</span> *pnData);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
</font><font color="#000000"><b>unqlite_kv_cursor_data_callback</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor,</font><font color="#0000ff">int</font><font color="#000000">
(*xConsumer)(</font><font color="#0000ff">const</font><font color="#000000">
</font><font color="#0000ff">void</font><font color="#000000">
*,</font><font color="#0000ff">unsigned</font><font color="#000000">
</font><font color="#0000ff">int</font><font color="#000000">,</font><font color="#0000ff">void</font><font color="#000000">
*),</font><font color="#0000ff">void</font><font color="#000000">
*pUserData);</font></font></font></p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><br>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#000000"><font face="Verdana, sans-serif"><b>Deleting
Records using Database Cursors</b></font></font><font color="#000000">
</font></font></font>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><br>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#0000ff">int</font><font color="#000000">
u</font><font color="#000000"><b>nqlite_kv_cursor_delete_entry</b></font><font color="#000000">(<span style="color: blue;">unqlite_kv_cursor</span>
*pCursor);</font></font></font></p>


<p style="margin-left: 1.25cm; margin-bottom: 0cm;"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><font color="#000000"></font></font></font></p><p style="margin-left: 1.25cm; font-weight: normal;"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"></font></font></p>
<p style="margin-left: 1.25cm; font-weight: normal;"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><br>
</font></font></p>

<p><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b>Description</b></font></font></p>
<span style="font-weight: bold;"><br>
</span>
<p style="margin-left: 1.25cm;"><font face="Verdana, sans-serif"><font style="font-size: 11pt;" size="2"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><span style="font-weight: normal;"></span></font></font><a href="unqlite_compile.html"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><span style="font-weight: normal;"></span></font></font></a><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><span style="font-weight: normal;"> </span></font></font></font></font>
</p>
<p style="margin-left: 1.25cm;" lang="en-US"><font face="Verdana, sans-serif"><font size="2">Cursors
provide a mechanism by which you can iterate over the records in a
database. Using cursors, you can seek, fetch, move, and delete
database records. </font></font>
</p>


<p style="margin-left: 1.25cm;"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US">Before playing with cursors, you must first allocate a new cursor handle using</span></font></font><span lang="en-US">
 </span><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>unqlite_kv_cursor_init()</b></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-weight: normal;">. </span></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span style="font-style: normal;"><span style="font-weight: normal;">This
is often the first UnQLite cursor API call that an application makes
and is a prerequisite in order to use cursors. When
done, you must call </span></span></font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span style="font-style: normal;"><b>unqlite_kv_cursor_release()</b></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span style="font-style: normal;"><span style="font-weight: normal;">
to release any allocated resource by the cursor and thus to avoid
memory leaks.</span></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span style="font-weight: normal;">
</span></font></font></font>
</p>

<p style="margin-left: 1.25cm; font-weight: normal;"><br>
</p>

<p style="margin-left: 1.25cm;"><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span style="font-weight: normal;">To
iterate over database records, from the first record to the last,
simply call  </span></font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>unqlite_kv_cursor_first_entry()
</b></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-weight: normal;">with
successive call to </span></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><b>
</b></span></font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>unqlite_kv_cursor_next_entry()
</b></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-weight: normal;">until
it return a value other than UNQLITE_OK (See example below). Note
that you can call  </span></span></font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>unqlite_kv_cursor_valid_entry()
</b></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-weight: normal;">to
check if the cursor is pointing to a valid record (This will return 1
when valid. 0 otherwise)</span></span></font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>.</b></span></font></font></font></p>

<p style="margin-left: 1.25cm;" lang="en-US"><br>
</p>

<p style="margin-left: 1.25cm;"><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-weight: normal;">To
iterate over database records, from the last record to the first,
simply call  </span></span></font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>unqlite_kv_cursor_last_entry()
</b></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-weight: normal;">with
successive call to </span></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><b>
</b></span></font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>unqlite_kv_cursor_prev_entry()
</b></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-weight: normal;">until
it return a value other than UNQLITE_OK (See example below). Note
that you can call  </span></span></font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>unqlite_kv_cursor_valid_entry()
</b></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-weight: normal;">to
check if the cursor is pointing to a valid record (This will return 1
when valid. 0 otherwise)</span></span></font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>.</b></span></font></font></font></p>
<p style="margin-left: 1.25cm;"><br>
<font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"></span></font></font></font></p>
<p style="margin-left: 1.25cm;">
</p>
<p style="margin-left: 1.25cm; font-weight: normal;"><font face="Verdana, sans-serif"><font color="#000000"><font size="2"><span lang="en-US">You
can also use cursors to search for records and start the iteration
process from there. To do that, simply call  </span></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>unqlite_kv_cursor_seek()
</b></span></font></font></font><font color="#000000"><font size="2"><span lang="en-US">with
the target record key and the seek direction (Last argument). The
seek direction can take the following value:</span></font></font></font></p>
<p style="margin-left: 1.25cm; font-weight: normal;"><font face="Verdana, sans-serif"><font color="#000000"><font size="2"><span lang="en-US"><br>
</span></font></font></font></p>


<p style="margin-left: 1.25cm; margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><b><font color="#000000"><span lang="en-US">UNQLITE_CURSOR_MATCH_EXACT
or 0 (default)</span></font></b></font></font></p>

<p style="margin-left: 2.5cm; font-weight: normal;"><font face="Verdana, sans-serif"><font color="#000000"><font size="2"><span lang="en-US">Default
search method supported by all key/value storage subsystem. An exact
match is performed. If the record exists, the cursor is left pointing
to it. Otherwise it is left pointing to EOF and </span></font></font><font color="#000000"><font size="2"><span lang="en-US"><b>UNQLITE_NOTFOUND</b></span></font></font><font color="#000000"><font size="2"><span lang="en-US">
is returned.    </span></font></font></font>
</p>

<p style="margin-left: 1.25cm; font-weight: normal;"><br>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><b><font color="#000000"><span lang="en-US">UNQLITE_CURSOR_MATCH_LE</span></font></b></font></font></p>


<p style="margin-left: 2.5cm; font-weight: normal;"><font face="Verdana, sans-serif"><font color="#000000"><font size="2"><span lang="en-US">The
cursor is left pointing to the largest key in the database that is
smaller than (pKey/nKey). If the database contains no keys smaller
than (pKey/nKey), the cursor is left at EOF. </span></font></font></font>
</p>

<p style="margin-left: 2.5cm; font-weight: normal;"><font face="Verdana, sans-serif"><font color="#000000"><font size="2"><span lang="en-US">This
option have sense only if the underlying key/value storage subsystem
support range search (i.e: B+Tree, R+Tree, etc.). Otherwise this
option is ignored and an exact match is performed.</span></font></font></font></p>

<p style="margin-left: 2.5cm; font-weight: normal;"><br>
</p>

<p style="margin-left: 1.25cm; margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><b><font color="#000000"><span lang="en-US">UNQLITE_CURSOR_MATCH_GE</span></font></b></font></font></p>


<p style="margin-left: 2.5cm; font-weight: normal;"><font face="Verdana, sans-serif"><font color="#000000"><font size="2"><span lang="en-US">The
cursor is left pointing to the smallest key in the database that is
larger than (pKey/nKey). If the database contains no keys larger than
(pKey/nKey), the cursor is left at EOF. </span></font></font></font>
</p>

<p style="margin-left: 2.5cm; font-weight: normal;"><font face="Verdana, sans-serif"><font color="#000000"><font size="2"><span lang="en-US">This
option have sense only if the underlying key/value storage subsystem
support range search (i.e: B+Tree, R+Tree, etc.). Otherwise this
option is ignored and an exact match is performed.</span></font></font></font></p>
<p style="margin-left: 2.5cm; font-weight: normal;"><font face="Verdana, sans-serif"><font color="#000000"><font size="2"><span lang="en-US"><br>
</span></font></font></font></p>

<p style="font-weight: normal; margin-left: 40px;"><font face="Verdana, sans-serif"><font color="#000000"><font size="2"><span lang="en-US">To
retrieve record <span style="font-weight: bold;">key/data</span> from a valid cursor (</span></font></font><font color="#000000"><font size="2"><span lang="en-US"><i>Tip:
call </i></span></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><span style="font-style: normal;"><b>unqlite_kv_cursor_valid_entry()
</b></span></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-style: normal;">to
test cursor validity ) simply use the following interface:</span></span></font></font></font></font></p>
<p style="font-weight: normal; margin-left: 40px;"><font face="Verdana, sans-serif"><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-style: normal;"><br>
</span></span></font></font></font></font></p>

<p style="margin-left: 2.3cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#000000"><b>unqlite_kv_cursor_key(</b></font><font color="#000000">);</font></font></font></p>

<p style="margin-left: 2.3cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#000000"><b>unqlite_kv_cursor_key_callback</b></font><font color="#000000">();</font></font></font></p>

<p style="margin-left: 2.3cm; margin-bottom: 0cm;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#000000"><b>unqlite_kv_cursor_data</b></font><font color="#000000">();</font></font></font></p>

<p style="margin-left: 2.3cm; margin-bottom: 0cm; font-weight: normal;" lang="en-US">
<font face="Courier New, monospace"><font size="2"><font color="#000000"><font face="Courier New, monospace"><span style="font-style: normal;"><b>unqlite_kv_cursor_data_callback</b></span></font></font><font color="#000000"><font face="Verdana, sans-serif"><span style="font-style: normal;">();</span></font></font></font></font></p>

<p style="margin-bottom: 0cm; font-weight: normal; margin-left: 40px;" lang="en-US"><br>
</p>

<p style="margin-bottom: 0cm; font-weight: normal; margin-left: 40px;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#000000"><font face="Verdana, sans-serif"><span style="font-style: normal;">These
interfaces works exactly like their high-level thread-safe client:
<a href="unqlite_kv_fetch.html">unqlite_kv_fetch()</a> and <a href="unqlite_kv_fetch_callback.html">unqlite_kv_fetch_callback()</a>. See below for an
usage or example or refer to the high-level client API description
for additional information.</span></font></font></font></font></p>

<p style="margin-bottom: 0cm; font-weight: normal; margin-left: 40px;" lang="en-US"><br>
</p>

<p style="margin-bottom: 0cm; font-weight: normal; margin-left: 40px;" lang="en-US"><font face="Courier New, monospace"><font size="2"><font color="#000000"><font face="Verdana, sans-serif"><span style="font-style: normal;">To
delete a record from the database using the cursor interface, simply
point to the target record using </span></font></font><font color="#000000"><span style="font-style: normal;"><b>unqlite_kv_cursor_seek() </b></span></font><font color="#000000"><font face="Verdana, sans-serif"><span style="font-style: normal;">and
call </span></font></font><font color="#000000"><span style="font-style: normal;">u</span></font><font color="#000000"><span style="font-style: normal;"><b>nqlite_kv_cursor_delete_entry()
</b></span></font><font color="#000000"><font face="Verdana, sans-serif"><span style="font-style: normal;">after</span></font></font><font color="#000000"><font face="Verdana, sans-serif"><span style="font-style: normal;"><b>
</b></span></font></font><font color="#000000"><font face="Verdana, sans-serif"><span style="font-style: normal;">successful
seek (See below for an usage example).</span></font></font></font></font></p>

<p style="margin-bottom: 0cm; font-weight: normal; margin-left: 40px;" lang="en-US"><br>
</p>

<p style="margin-bottom: 0cm; margin-left: 40px;"><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><b>unqlite_kv_cursor_init()
</b></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-style: normal;"><span style="font-weight: normal;">and
</span></span></span></font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><span style="font-style: normal;"><b>unqlite_kv_cursor_release()
</b></span></span></font></font></font><font color="#000000"><font face="Verdana, sans-serif"><font size="2"><span lang="en-US"><span style="font-style: normal;"><span style="font-weight: normal;">are
thread-safe while the other interfaces are not. Caller must
ensure that no other thread can access the same cursor handle. Otherwise
the result is undefined.</span></span></span></font></font></font></p>



<p style="margin-left: 1.25cm;"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><font face="Verdana, sans-serif"><span style="font-style: normal;"><span style="font-weight: normal;"><br>
</span></span></font></font></font></p>




<p><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b>Parameters</b></font></font></p>
<p><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b><br>
</b></font></font></p>
<table style="width: 100%;" id="table_code" border="1" bordercolor="#000000" cellpadding="2" cellspacing="0">
<tbody><tr valign="top"><td width="28%"><p style="margin-left: 1.25cm;"><font color="#000000"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b>pCursor</b></font></font></font></p>
      </td>
      <td width="72%">
      <p> <font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2">A pointer to a correctly initialized database cursor.</font></font></p>
      </td>
    </tr>
    
  </tbody>
</table>

<p><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b><br>
</b></font></font></p>
<p><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b>Return
value</b></font></font></p>
<p><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b><br>
</b></font></font></p>
<p style="margin-left: 1.25cm; font-weight: normal;"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b style="font-family: Courier New;">UNQLITE_OK</b>
is returned on successfull seek. Any other return value typically <b style="font-family: Courier New;">UNQLITE_EOF</b>,<b> <span style="font-family: Courier New;">UNQLITE_NOTFOUND</span>
</b>indicates invalid seek (i.e. No more records to fetch). </font></font>
</p>
<p style="margin-left: 1.25cm; font-weight: normal;">
</p>

<p style="margin-left: 1.25cm; font-weight: normal;"><br>
<font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><span style="font-weight: bold;"></span></font></font></p>

<p style="margin-left: 1.25cm; font-weight: normal;">
</p>
<p style="margin-left: 1.25cm; font-weight: normal;">
</p>
<p style="margin-left: 1.25cm; font-weight: normal;">
</p>

<font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b>Example<br>
<br>
</b></font></font>
<p style="margin-left: 1.25cm;"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><a href="http://unqlite.org/db/unqlite_csr_intro.c"><font face="Verdana, sans-serif"><span style="font-weight: normal;">Compile this C file</span></font></a><font face="Verdana, sans-serif"><span style="font-weight: normal;">
for a smart introduction to these interface.</span></font></font></font></p>
<br>
<div style="text-align: left; margin-left: 12px; width: 1034px;" id="code"><small style="font-family: Courier New;">
<span style="color: blue;"></span></small><small style="font-family: Courier New;"><span style="color: blue;">#include <span style="color: red;">&lt;unqlite.h&gt;<br>
<br>
</span></span></small><small style="font-family: Courier New;"><span style="color: blue;">
int</span> rc;<br>
<span style="color: blue;">unqlite</span> *pDb;<br><span style="color: blue;">
unqlite_kv_cursor</span> *pCursor;<br>
<span style="color: blue;">unqlite_int64</span> iData;<br>
<br>
</small><small style="font-family: Courier New;"><span style="color: green;">// Open our database;</span></small><br style="font-family: Courier New;">
<small><span style="font-family: Courier New;">rc = <a href="unqlite_open.html">unqlite_open</a>(&amp;pDb,<span style="color: red;">"test.db"</span>,UNQLITE_OPEN_CREATE);<br>
<span style="color: blue;">if</span>( rc != UNQLITE_OK ){ <span style="color: blue;">return</span>; }<br>
</span></small><small style="font-family: Courier New;"><span style="color: green;"><br></span></small><small style="font-family: Courier New;"><span style="color: green;"><span style="color: black;"> </span></span></small><small style="font-family: Courier New;"><span style="color: green;">//Store some records </span></small><small style="font-family: Courier New;"><span style="color: green;"><a href="unqlite_kv_store.html">unqlite_kv_store()</a>, </span></small><a href="unqlite_kv_append.html"><small style="font-family: Courier New;"><span style="color: green;">unqlite_kv_append()</span></small></a><small style="font-family: Courier New;"><span style="color: green;">...</span></small><font color="#008000"><font face="Courier New, monospace"><font size="2"><span lang="en-US"><span style="font-style: normal;"><span style="font-weight: normal;"><br>
<br>
/*
Allocate a new cursor instance */</span></span></span></font></font></font>



<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">	rc
= <span style="font-weight: bold;">unqlite_kv_cursor_init</span>(pDb,&amp;pCursor);</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">	</font><font color="#0000ff">if</font><font color="#000000">(
rc != UNQLITE_OK ){ <span style="color: blue;">return</span>; }<br>
</font></font></font></p>
<br>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">	</font><font color="#008000">/* Point to the first record */</font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">	</font><font color="#0000ff">for</font><font color="#000000">(
<span style="font-weight: bold;">unqlite_kv_cursor_first_entry</span>(pCursor) ; 
<span style="font-weight: bold;">unqlite_kv_cursor_valid_entry</span>(pCursor) ; <span style="font-weight: bold;">unqlite_kv_cursor_next_entry</span>(pCursor) ){ </font></font></font>
</p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">		</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">		</font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#008000"><br>
</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp; /*
Consume the key */</font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; printf(</font><font color="#a31515">"\nKey
==&gt;\n\t"</font><font color="#000000">);</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-weight: bold;">unqlite_kv_cursor_key_callback</span>(pCursor,DataConsumerCallback,0);</font></font></font></p>
<br>
<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp; /* Extract data length */</font></font></font>
</p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-weight: bold;">unqlite_kv_cursor_data</span>(pCursor,NULL,<span style="font-weight: bold;">&amp;iData</span>);</font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp; printf(</font><font color="#a31515">"\nData
length ==&gt; %lld\n\t"</font><font color="#000000">,iData);</font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
</font></font></font></p>
<p style="margin-bottom: 0cm;">
</p>
<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp; /*
Consume the data */</font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">		</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#008000"><font face="Courier New, monospace"><font size="2">&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000000"><span style="font-weight: bold;">unqlite_kv_cursor_data_callback</span>(pCursor,DataConsumerCallback,0);</font></font></font></font></p>


<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">&nbsp;	}</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2"><br>
</font></font></font></p>


<p style="margin-bottom: 0cm;"><font color="#008000"><font face="Courier New, monospace"><font size="2">/*
Delete a record */</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">rc
=
<span style="font-weight: bold;">unqlite_kv_cursor_seek</span>(pCursor,<font color="#ff0000">"MyRecord"</font>,-1</font></font></font><font color="#008000"><font face="Courier New, monospace"><font size="2"> /* Key length */</font></font></font><font color="#000000"><font face="Courier New, monospace"><font size="2">,UNQLITE_CURSOR_MATCH_EXACT);</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2"><span style="color: blue;">if</span>(
rc == UNQLITE_OK ){</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000">&nbsp; &nbsp;  
<font face="Courier New, monospace"><font size="2">rc = <span style="font-weight: bold;">unqlite_kv_cursor_delete_entry</span>(pCursor);</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">&nbsp;</font></font></font><font face="Courier New, monospace"><font size="2"><font color="#0000ff"> if</font><font color="#000000">(
rc != UNQLITE_OK ){ <span style="color: blue;">return</span>; }</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">}</font></font></font></p>

<br>
<font face="Courier New, monospace"><font size="2"><font color="#008000">/* Point to the last record */</font></font></font><font face="Courier New, monospace"><font size="2"><font color="#000000"><span lang="en-US"><span style="font-style: normal;"><span style="font-weight: normal;"><br>
rc
= <span style="font-weight: bold;">unqlite_kv_cursor_last_entry</span>(pCursor);<br>
</span></span></span></font></font></font><font face="Courier New, monospace"><font size="2"><font color="#0000ff">if</font><font color="#000000">(
rc != UNQLITE_OK ){ <span style="color: blue;">return</span>; }<br>
<br>
</font></font></font>
<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">	</font><font color="#008000">/*
Iterate over the records */</font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">	</font><font color="#0000ff">while</font><font color="#000000">(
<span style="font-weight: bold;">unqlite_kv_cursor_valid_entry</span>(pCursor) ){</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">		</font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">		</font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">		</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000">&nbsp;&nbsp; &nbsp;&nbsp; </font><font face="Courier New, monospace"><font size="2"><font color="#008000">/*
Consume the key */</font></font></font>

</p>
<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">&nbsp;&nbsp; printf(</font><font color="#a31515">"\nKey
==&gt;\n\t"</font><font color="#000000">);</font></font></font></p>


<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">&nbsp;&nbsp; <span style="font-weight: bold;">unqlite_kv_cursor_key_callback</span>(pCursor,DataConsumerCallback,0);</font></font></font></p>

<br>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#008000">&nbsp;&nbsp; /* Extract data length */</font></font></font>
</p>


<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">&nbsp;&nbsp; <span style="font-weight: bold;">unqlite_kv_cursor_data</span>(pCursor,NULL,<span style="font-weight: bold;">&amp;iData</span>);</font></font></font></p>


<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">&nbsp;&nbsp; printf(</font><font color="#a31515">"\nData
length ==&gt; %lld\n\t"</font><font color="#000000">,iData);</font></font></font></p>


<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
</font></font></font></p>

<p style="margin-bottom: 0cm;">
</p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#008000">&nbsp;&nbsp; /*
Consume the data */</font></font></font></p>


<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">		</font></font></font></p>


<p style="margin-bottom: 0cm;"><font color="#008000"><font face="Courier New, monospace"><font size="2">&nbsp;&nbsp; <font color="#000000"><span style="font-weight: bold;">unqlite_kv_cursor_data_callback</span>(pCursor,DataConsumerCallback,0);</font></font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000">&nbsp;            </font></p>
<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#008000">&nbsp;&nbsp; /*
Point to the previous record */</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">&nbsp;&nbsp;		<span style="font-weight: bold;">unqlite_kv_cursor_prev_entry</span>(pCursor);</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2">	}</font></font></font></p>

<p style="margin-bottom: 0cm;"><br>
</p>

<p style="margin-bottom: 0cm;"><font face="Courier New, monospace"><font size="2"><font color="#000000">	</font><font color="#008000">/*
Finally, Release our cursor */</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="Courier New, monospace"><font size="2"><span style="font-weight: bold;">	unqlite_kv_cursor_release</span>(pDb,pCursor);</font></font></font></p>

<small style="font-family: Courier New;"><span style="color: green;"></span></small><small style="font-family: Courier New;"><span style="color: green;"><span style="color: black;"><br>
</span></span></small><small style="font-family: Courier New;"><span style="color: green;"><span style="color: black;"><span style="color: green;">//Auto-commit the transaction and close our handle</span></span></span></small><br>
<small style="font-family: Courier New;"><span style="color: green;"><span style="color: black;"><a href="unqlite_close.html">unqlite_close</a>(pDb);<span style="color: green;"></span><br style="font-family: Verdana;">
</span></span></small><br>
</div>
<font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b><br>
</b></font></font>
<p><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b>See also<br>
</b></font></font></p>

<p><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><b><br>
</b></font></font></p>


<p style="margin-left: 1.25cm;"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><a href="http://unqlite.org/db/unqlite_func_intro.c"><font face="Verdana, sans-serif"><span style="font-weight: normal;"></span></font></a><font face="Verdana, sans-serif"><span style="font-weight: normal;"><a href="unqlite_vm_release.html">unqlite_kv_fetch</a></span></font></font></font><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><font face="Verdana, sans-serif"><span style="font-weight: normal;"></span></font></font></font><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><font face="Verdana, sans-serif"><span style="font-weight: normal;"></span></font></font></font><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><font face="Verdana, sans-serif"><span style="font-weight: normal;"></span></font></font></font><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><font face="Verdana, sans-serif"><span style="font-weight: normal;">, <a href="unqlite_vm_exec.html">unqlite_kv_fetch_callback</a>, <a href="unqlite_kv_append.html">unqlite_kv_append</a>, <a href="unqlite_kv_store.html">unqlite_kv_store</a>, <a href="unqlite_open.html">unqlite_open</a>, <a href="unqlite_close.html">unqlite_close</a>.<br>
</span></font></font></font></p>
<p style="margin-left: 1.25cm;"><font face="Verdana, sans-serif"><font style="font-size: 10pt;" size="2"><font face="Verdana, sans-serif"><span style="font-weight: normal;"><br>
</span></font></font></font></p>


</div>
<hr style="width: 100%; height: 2px;">
<div style="text-align: right; margin-top: 0px; height: 91px;"><small><small><a href="http://www.symisc.net/"><img style="border: 0px solid ; width: 170px; height: 70px;" alt="Symisc Systems" src="../images/symisc.png"></a></small></small>
<div style="text-align: left; margin-top: 0px; height: 14px;"><small><small style="font-family: Verdana;">Copyright Â© <a href="http://www.symisc.net/">Symisc Systems</a></small></small><br>
</div>
</div>
</div>

</body></html>